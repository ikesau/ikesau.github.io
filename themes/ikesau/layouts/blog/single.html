{{ define "extra-css" }}
<link rel="stylesheet" href="/css/blog.css">
{{ if .Params.extra_css }}
<link rel="stylesheet" href="/css/{{.Params.extra_css}}.css">
{{ end }}
{{ if .Params.code_highlighting }}
<link rel="stylesheet" href="/vendor/highlightjs-shades-of-purple.css">
{{ end }}
{{ end }}

{{ define "extra-js" }}
<script src="/vendor/popper.min.js"></script>
<script src="/vendor/tippy.min.js"></script>
{{ if .Params.code_highlighting }}
<script src="/vendor/highlight.min.js"></script>
<script>
hljs.configure({cssSelector: "code", languages: ["javascript"]});
hljs.highlightAll();
</script>
{{ end }}
<script>
    const tippyOpts = {
      content(e) {
        const labelledBy = e.getAttribute("aria-labelledby");
        const label = document.getElementById(labelledBy);
        return label.innerHTML;
      },
      allowHTML: true,
      interactive: true,
      arrow: false,
      onMount(instance) {
        tippy(instance.popper.querySelectorAll("sup"), tippyOpts);
      },
    };
    tippy("sup", tippyOpts);
</script>
{{ end }}


{{ define "main" }}
<article id="{{ .Title | urlize }}" class="blog-post">
  <h1>{{ .Title }}</h1>
  {{ with .Params.tags }}
  <div class="post-tags">
    {{ range . }}<a href="/tags/{{ . | urlize }}/" class="tag">{{ . }}</a>{{ end }}
  </div>
  {{ end }}
  {{ .Content }}

  {{ if or .Params.gotosocial_post_id .Params.bluesky_post_url }}
  <section id="comments-section">
    <h2>Comments</h2>
    <div class="comments-links">
      {{ with .Params.gotosocial_post_id }}
      <a href="https://micro.ikesau.co/@ikesau/{{ . }}" target="_blank" rel="noopener">View on GotoSocial</a>
      {{ end }}
      {{ with .Params.bluesky_post_url }}
      <a href="{{ . }}" target="_blank" rel="noopener">View on Bluesky</a>
      {{ end }}
    </div>
    <button id="load-comments">Load Comments</button>
    <div id="comments"
         data-gotosocial-id="{{ .Params.gotosocial_post_id }}"
         data-gotosocial-token="{{ .Site.Params.gotosocial_token }}"
         data-bluesky-url="{{ .Params.bluesky_post_url }}">
    </div>
  </section>
  <link rel="stylesheet" href="/css/comments.css">
  <script src="/js/comments.js"></script>
  {{ end }}
</article>
{{ end }}
